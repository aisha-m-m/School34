# Школа 34 — ASP.NET Core MVC + SQLite

Небольшой учебный сайт школы: администрация, лучшие ученики, кружки и расписание. Проект создан для дипломной работы и демонстрирует базовую архитектуру ASP.NET Core MVC с EF Core и Cookie‑аутентификацией.

## Основное

- Язык интерфейса: русский (ru-RU)
- Стек: .NET 9, ASP.NET Core MVC, EF Core (SQLite), Bootstrap
- Аутентификация: cookie (упрощённый вход администратора)
- Данные: локальная SQLite БД с автосозданием и сидом демо‑данных
- Медиа: локальные SVG‑изображения в `wwwroot/images`

## Установка и запуск по ОС

Короткие шаги без автоскриптов. Если что‑то уже установлено — просто пропустите этот пункт.

### Windows

- Установите .NET SDK 9 (или 8 LTS):
  - winget: `winget install Microsoft.DotNet.SDK.9`
  - сайт: https://dotnet.microsoft.com/download/dotnet
- Проверьте: `dotnet --version` (8.x/9.x)
- Доверить dev‑сертификат (https): `dotnet dev-certs https --trust`
- Запуск из корня репозитория:
  - `dotnet restore`
  - `dotnet run`
- Откройте URL из консоли (127.0.0.1 с динамическим портом).

### macOS

- Установите .NET SDK 9/8:
  - Homebrew: `brew install --cask dotnet-sdk` (или `brew install dotnet-sdk`)
  - сайт: https://dotnet.microsoft.com/download/dotnet
- Проверьте: `dotnet --version`
- Доверить dev‑сертификат: `dotnet dev-certs https --trust`
- Запуск:
  - `dotnet restore`
  - `dotnet run`
- Откройте URL из консоли.

### Linux

- Установите .NET SDK 9/8 из репозитория вашей системы или с сайта:
  - Debian/Ubuntu: репо Microsoft + `sudo apt install dotnet-sdk-9.0`
  - Fedora: `sudo dnf install dotnet-sdk-9.0`
  - Arch/Manjaro: `sudo pacman -S dotnet-sdk`
  - Альтернатива: https://dotnet.microsoft.com/download/dotnet
- Проверьте: `dotnet --version`
- (Опционально) dev‑сертификат для https: `dotnet dev-certs https`
- Запуск:
  - `dotnet restore`
  - `dotnet run`
- Откройте URL из консоли.

## Возможности

- Главная: приветствие + иллюстрация.
- Администрация: карточки сотрудников (директор, завуч, учителя).
- Лучшие ученики: карточки с краткой причиной награждения.
- Кружки: список секций с изображениями.
- Расписание: выбор класса, таблица по дням и временем.
- Режим админа: вход в подвале страницы, добавление/редактирование/удаление занятий.

## Руководство пользователя

- Навигация: верхнее меню — «Главная», «Администрация», «Лучшие ученики», «Наши кружки», «Расписание».
- Вход администратора: внизу страницы ссылка «Войти» (подвал). После входа станет «Выйти» и появятся админ‑кнопки в расписании.
- Расписание: выберите класс в выпадающем списке. У администратора справа видны кнопки «Редактировать» и «Удалить», сверху — «Добавить».
- Изображения: загружены локальные иллюстрации; заменить можно файлами в `wwwroot/images` или изменив `PhotoUrl` в базе.

## Доступ администратора

- Где войти: ссылка «Войти» в подвале любой страницы или адрес `/Account/Login`.
- Данные по умолчанию:
  - Код: `admin`
  - Пароль: `1234`
- Где изменить: файл `appsettings.json` — ключи `Admin:Code` и `Admin:Password`.
- Что может админ сейчас:
  - Добавлять/редактировать/удалять записи расписания на странице «Расписание».
- Как выйти: ссылка «Выйти» в подвале. Сессия хранится в cookie (обычное cookie‑вход через ASP.NET Core).
- Как «выкинуть» всех: поменяйте значения `Admin:Code/Password` и перезапустите приложение — существующие cookie потеряют смысл.
- Замечание по безопасности: это упрощённая схема для учебного проекта. Для реального использования лучше подключить ASP.NET Identity (учётные записи, сброс пароля, роли).

## Конфигурация

- Файл: `appsettings.json`
  - `ConnectionStrings:DefaultConnection`: путь к SQLite (`Data Source=school34.db`)
  - `Admin:Code` и `Admin:Password`: учётные данные упрощённого входа

## Карта страниц (URL)

- Главная: `/`
- Администрация: `/Staff`
- Лучшие ученики: `/Students`
- Наши кружки: `/Clubs`
- Расписание: `/Schedule` (параметр `cls=<номер_класса>`, например `/Schedule?cls=11`)
- Вход/выход: `/Account/Login`, `/Account/Logout`

## Структура проекта

```
Controllers/               // MVC контроллеры (Home, Staff, Students, Clubs, Schedule, Account)
Data/SchoolContext.cs      // DbContext и DbSet'ы (EF Core)
Models/                    // Доменные модели: StaffMember, Student, Club, ScheduleEntry
Services/DbInitializer.cs  // Сид демо‑данных при первом запуске
Views/                     // Razor‑представления
wwwroot/images/            // Локальные SVG‑изображения
appsettings*.json          // Настройки, в т.ч. Admin и строка подключения
Program.cs                 // Регистрация сервисов, EF Core, auth, ru-RU, EnsureCreated
```

## Полезно знать

- База создаётся автоматически (`EnsureCreated`) и наполняется демо‑данными. Чтобы сбросить — удалите файл `school34.db`.
- Основные маршруты: `/Staff`, `/Students`, `/Clubs`, `/Schedule`, вход — `/Account/Login`.
- Хотите полноценные роли и пользователей? Можно подключить ASP.NET Identity вместо упрощённого входа.

## Частые вопросы (FAQ)

- Не запускается https на macOS: выполните `dotnet dev-certs https --trust`, перезапустите браузер.
- Картинки не показываются: проверьте, что путь начинается с `~/images/...` или `/images/...`, а файл лежит в `wwwroot/images`.
- После изменения сид‑данных старые записи остаются: удалите файл БД `school34.db` и запустите заново, чтобы сид сработал повторно.

## Лицензия

Учебный проект. Используйте свободно в образовательных целях.